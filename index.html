<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>rasterizer</title>
<link rel="stylesheet" type="text/css" href="Styles/Rasterizer.css" />
<script src="JavaScript/tsrasterizer.js"></script>
</head>
<body>

<div id="framebuffer"></div>

<a href="TypeScript/Box.ts">Box.ts</a>
<a href="TypeScript/CanvasRasterizer.ts">CanvasRasterizer.ts</a>
<a href="TypeScript/DivRasterizer.ts">DivRasterizer.ts</a>
<a href="TypeScript/Edge.ts">Edge.ts</a>
<a href="TypeScript/Matrix4.ts">Matrix4.ts</a>
<a href="TypeScript/Rasterizer.ts">Rasterizer.ts</a>
<a href="TypeScript/Span.ts">Span.ts</a>
<a href="TypeScript/Vector4.ts">Vector4.ts</a>

<p>
    rasterizer:
    <select id="rasterizer" onchange="createRasterizer()">
        <option selected="selected">canvas</option>
        <option>div</option>
    </select>

<p>
    pixel size:
    <select id="pixelSize" onchange="createRasterizer()">
        <option value="2">2x2</option>
        <option value="4">4x4</option>
        <option value="8">8x8</option>
        <option value="16" selected="selected">16x16</option>
        <option value="32">32x32</option>
        <option value="64">64x64</option>
        <option value="128">128x128</option>
    </select>
</p>

<p>
    <input id="clearFramebufferCheckbox" type="checkbox" onchange="clearFramebufferChanged(this)" checked="checked" />
    <label for="clearFramebufferCheckbox">clear framebuffer</label>
</p>

<script>
var rast = null;
createRasterizer();

var clearFramebuffer = true;

var boxes = new Array();
boxes.push(new Box(new Vector4(-1, -1, -1), 1, new Vector4(255, 0, 0, 255)));
boxes.push(new Box(new Vector4(-1, -1, 1), 1, new Vector4(0, 255, 0, 255)));
boxes.push(new Box(new Vector4(-1, 1, -1), 1, new Vector4(0, 0, 255, 255)));
boxes.push(new Box(new Vector4(-1, 1, 1), 1, new Vector4(255, 255, 255, 255)));
boxes.push(new Box(new Vector4(1, -1, -1), 1, new Vector4(64, 64, 64, 255)));
boxes.push(new Box(new Vector4(1, -1, 1), 1, new Vector4(255, 255, 0, 255)));
boxes.push(new Box(new Vector4(1, 1, -1), 1, new Vector4(0, 255, 255, 255)));
boxes.push(new Box(new Vector4(1, 1, 1), 1, new Vector4(255, 0, 255, 255)));

var r = 0.0;
function render()
{
    if(clearFramebuffer)
        rast.clear();

    r += (Math.PI / 180.0) * 2;
    var mr = Matrix4.rollRotation(r);
    var my = Matrix4.yawRotation(-r * 1.5);
    var mt = Matrix4.translation(new Vector4(0, 0, -6));
    rast.setModelviewMatrix(mt.multiply(my.multiply(mr)));

    for(var i = 0; i < boxes.length; ++i)
        boxes[i].render(rast);

    rast.flush();
}

setInterval(render, 50);

function createRasterizer()
{
    var framebuffer = document.getElementById("framebuffer");
    var rasterizer = document.getElementById("rasterizer");
    var pixelSize = document.getElementById("pixelSize");

    var selectedRasterizer = rasterizer.options[rasterizer.selectedIndex].value;
    var selectedPixelSize = parseInt(pixelSize.options[pixelSize.selectedIndex].value);

    if(selectedRasterizer == "div")
        rast = new DivRasterizer(framebuffer, selectedPixelSize);
    else
        rast = new CanvasRasterizer(framebuffer, selectedPixelSize);
}

function clearFramebufferChanged(clearFramebufferCheckbox)
{
    clearFramebuffer = clearFramebufferCheckbox.checked;
}
</script>

</body>
</html>
